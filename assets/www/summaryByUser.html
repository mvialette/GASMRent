<!DOCTYPE HTML>
<html>
<head>
<title>G.A.S.M. Rent</title>

<meta name="viewport" content="width=device-width, initial-scale=1.0">

<!-- Javascripts -->
<script type="text/javascript" charset="utf-8" src="./js/cordova.js"></script>
<script type="text/javascript" charset="utf-8"
	src="./js/jquery-2.0.3.min.js"></script>
<script type="text/javascript" charset="utf-8"
	src="./js/jquery.i18n.properties-min-1.0.9.js"></script>
<script type="text/javascript" charset="utf-8"
	src="./js/bootstrap.min.js"></script>
<script type="text/javascript" charset="utf-8" src="./js/respond.min.js"></script>
<script type="text/javascript" charset="utf-8" src="./js/gasm-rent.js"></script>

<script type="text/javascript">
	window.onload = function() {
		alert("aaaaa");
		//load I18N bundles
		jQuery(document).ready(function() {
			initLanguages();
		});
		
		alert("aaaaab");
		
		getEquipmentsForTheUser();
		
		alert("aaaaac");
	}

	function loadBundles(lang) {
		jQuery.i18n.properties({
			name : 'gasmrent',
			path : 'i18n/',
			mode : 'both',
			language : lang,
			callback : function() {
				
				alert("q");
				jQuery.i18n.prop("summaryByUserPageTitle");
				
				alert("s");
				$("#summaryByUserPageTitle").html(summaryByUserPageTitle);

				alert("d");
				jQuery.i18n.prop("summaryByUserDescription");

				alert("f");
				//jQuery.i18n.prop("summaryByUserDescription");
				//$("#summaryByUserDescription").html(summaryByUserDescription);
				
				jQuery.i18n.prop("continueRentalForSomeoneElse");
				
				alert("g");
				$("#continueRentalForSomeoneElse").html(continueRentalForSomeoneElse);
				
				alert("h");
				jQuery.i18n.prop("summaryByDivingEvent");
				alert("j");
				$("#summaryByDivingEvent").html(summaryByDivingEvent);
				alert("k");
				jQuery.i18n.prop("back");
				alert("l");
				$("#back").html(back);
			}
		});
	}

	function getEquipmentsForTheUser() {

		alert("a");
		
		var divingEventId = getURLParameter("divingEventId");
		var userId = getURLParameter("userId");
		
		alert("divingEventId="divingEventId);
		
		alert("userId="+userId);

		$("#summaryByUserDescription").html(
				summaryByUserDescription(userId, divingEventId, '20/11/2013'));

		alert("b");
		
		var rentalRecordsStringFromLocalStorage = JSON
				.parse(window.localStorage.getItem("rentalRecords"));

		var rentalRecordArrays = new Array();
		
		$.each(rentalRecordsStringFromLocalStorage, function(idx2,oneRentalRecord) {                    
			rentalRecordArrays.push(oneRentalRecord);
			alert("c="+oneRentalRecord);
		});
		
		alert("d="+rentalRecordArrays);
		var listOfRentedEquipments = "<ul>";
		
		$.each(rentalRecordArrays, function(i, oneElement) {
			alert("e="+oneElement);
			var currentElementJSON = JSON.parse(oneElement);
			alert("f="+currentElementJSON);
			
			if (currentElementJSON.divingEventId == divingEventId && currentElementJSON.userId == userId) {
				listOfRentedEquipments = listOfRentedEquipments + "<li>" + currentElementJSON.equipmentId + "</li>";
				alert("g="+listOfRentedEquipments);
			}
		});
		
		alert("h="+listOfRentedEquipments);
		listOfRentedEquipments = listOfRentedEquipments + "</ul>";
		
		alert("i="+listOfRentedEquipments);
		$("#listOfEquipments").html(listOfRentedEquipments);
		
	}
</script>

<!-- CSS -->
<link href="./css/bootstrap.min.css" rel="stylesheet" media="screen">
<link href="./css/gasm.css" rel="stylesheet" media="screen">
</head>
<body>
	<div class="container">
		<div class="row">
			<div class="col-12 pageTitle" id="summaryByUserPageTitle"></div>
		</div>
		<div class="row">
			<div class="col-12 pageSection">
				<div class="row largeRow">
					<div class="col-12 text-center" id="summaryByUserDescription"></div>
				</div>

				<div class="row largeRow">
					<div class="col-12 text-center" id="listOfEquipments"></div>
				</div>

				<div class="row largeRow">
					<div class="col-12 text-center">
						<a class="largeButton" href="./chooseEventAndUser.html"
							id="continueRentalForSomeoneElse"></a>
					</div>
				</div>
				
				<div class="row largeRow">
					<div class="col-12 text-center">
						<a class="largeButton" href="./summaryByDivingEvent.html"
							id="summaryByDivingEvent"></a>
					</div>
				</div>

				<div class="row largeRow">
					<div class="col-12 text-center">
						<a class="largeButton" href="./index.html" id="back"></a>
					</div>
				</div>
			</div>
		</div>
	</div>
</body>
</html>